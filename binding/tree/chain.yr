mod binding::tree::chain;

import binding::tree::c_tree;

pub class TreeChain {
    let mut _first : tree_t = null;
    let mut _last : tree_t = null;

    pub self () {}

    pub fn append (mut self, t : tree_t)-> dmut &TreeChain {
        if (t is null) { __pragma!panic (); }
        if (self._first is null) {
            self._first = t;
            self._last = t;
        } else {
            c_binding_tree_chain_set (self._last, t);
            self._last = t;
        }

        return alias self;
    }

    pub fn getTree (self)-> tree_t {
        return self._first;
    }

}

pub class BlockChain {
    let mut _first : tree_t = null;
    let mut _last : tree_t = null;

    pub self () {}

    pub fn append (mut self, t : tree_t)-> dmut &BlockChain {
        if (t is null) { __pragma!panic (); }
        if (self._first is null) {
            self._first = t;
            self._last = t;
        } else {
            c_binding_block_chain_set (self._last, t);
            self._last = t;
        }

        return alias self;
    }

    pub fn setSuperContext (mut self, block : tree_t) {
        let mut current = self._first;
        while (current !is null) {
            c_binding_set_block_super_context (current, block);
            current = c_binding_block_chain_get (current);
        }
    }

    pub fn getTree (self)-> tree_t {
        return self._first;
    }

}

pub struct
| bind : tree_t
| block : tree_t
 -> TreeSymbolMapping;
